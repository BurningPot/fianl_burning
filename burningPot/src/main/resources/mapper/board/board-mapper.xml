<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="board">
	<!-- HYD -->	
	<select id="selectBoard" parameterType="string" resultType="Board">
		SELECT BNUM, CATEGORY, BTITLE, MNUM, BDATE, MNAME ,MID, REPLY, BCOUNT 
		FROM BOARD JOIN MEMBER USING(MNUM) WHERE CATEGORY = #{bCategory} ORDER BY REPLY, BNUM DESC, BDATE
	</select>
	<select id="selectCount" parameterType="string" resultType="_int">
		SELECT COUNT(*) FROM BOARD WHERE CATEGORY = #{bCategory}
	</select>
	
	<select id="selectBoardDetail" parameterType="hashmap" resultType="Board">
		SELECT BNUM, CATEGORY, MCATEGORY ,BTITLE, BDATE, MNAME , MID, REPLY, BCONTENT 
		FROM BOARD JOIN MEMBER USING(MNUM) WHERE CATEGORY = #{bCategory} AND BNUM = #{bNum}
	</select>
	
	<update id="updateBoardReply" parameterType="hashmap">
		UPDATE BOARD SET REPLY = #{YorN} WHERE BNUM = #{bNum}
	</update>
	
	<delete id="deleteBoard" parameterType="_int">
		DELETE BOARD WHERE BNUM = #{bNum}
	</delete>
	
	
	<!-- HYD -->
	
	<!-- 예찬 mapper 부분 -->
	<select id="selectBoardList" resultMap="boardMem">
		SELECT b.*, m.* , (CASE WHEN CATEGORY='공지사항' THEN '1' ELSE '0' END) CATE FROM BOARD B JOIN MEMBER M ON(B.MNUM=M.MNUM) ORDER BY CATE DESC, BDATE DESC
	</select>
	
	<select id="selectBoardTotalContents" resultType="_int">
		SELECT COUNT(*) FROM BOARD
	</select>
	
	<select id="selectBaordOne" parameterType="_int" resultMap="boardMem">
		SELECT * FROM BOARD B JOIN MEMBER M ON(B.MNUM=M.MNUM) WHERE BNUM = #{boardNo}
	</select>
	
	<resultMap type="board" id="boardMem">
		<result column="BNUM" property="bNum"/>
		<result column="CATEGORY" property="category"/>
		<result column="BTITLE" property="bTitle"/>
		<result column="MNUM" property="mNum"/>
		<result column="BDATE" property="bDate"/>
		<result column="BCONTENT" property="bContent"/>
		<result column="REPLY" property="reply"/>
		<result column="BCOUNT" property="bCount"/>
		<result column="MID" property="mId"/>
		<result column="MNAME" property="mName"/>
		<result column="CATEGORY" property="category" />
	</resultMap>
	
	<update id="updateBcount" parameterType="_int">
		UPDATE BOARD SET BCOUNT = BCOUNT+1 WHERE BNUM = #{boardNo}
	</update>
	
	<insert id="insertBoard" parameterType="board">
		<selectKey keyProperty="bNum" resultType="_int" order="AFTER">
			SELECT SEQ_BOARD.CURRVAL FROM DUAL
		</selectKey>
		INSERT INTO BOARD VALUES(SEQ_BOARD.NEXTVAL, #{category}, #{bTitle}, #{mNum}, DEFAULT, #{bContent}, DEFAULT, DEFAULT, DEFAULT)
	</insert>
	<!-- 
	BNUM
	CATEGORY
	BTITLE
	MNUM
	BDATE
	BCONTENT
	BIMG
	REPLY
	BCOUNT -->
	
<!-- 	
	private int bNum;		// 글번호
	private String category;	// 글구분
	private String bTitle;		// 글제목
	private int mNum;		// 회원번호
	private String mId;			// 회원아이디
	private String mName;		// 회원 이름
	private Date bDate;			// 작성일
	private String bContent;	// 글내용
	private String bImg;		// 사진
	private String reply;		// 답변여부(관리자가 답변했는지)  Q&A에만 해당되는 사항일듯
	private int bCount;
	 -->
	
	<!-- 예찬 mapper 부분  끝 -->

</mapper>
